<!DOCTYPE html>


  
<html itemscope itemtype="https://schema.org/WebPage" class="no-js" lang="en">

<head prefix="og: http://ogp.me/ns#">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="siteBaseUrl" content="https://blog.ronan.us.kg/">
    <meta name="author" content="Ronan">
    <meta name="description" content="Bilberry Premium Theme for Hugo.">
    <meta name="keywords" content="blog,personal,responsive,search,font awesome,pages,posts,multilingual,syntax highlighting,premium,shortcuts">
    <meta name="generator" content="Hugo 0.136.2">
    <title>
        
           
               GDB调试 &vert; Ronan Blog
           
        
    </title>
    <meta itemprop="name" content="GDB调试">
    <meta itemprop="description" content="GDB调试 - Bilberry Premium Theme for Hugo.">
    <meta property="og:site_name" content="Ronan Blog">

    <meta property="og:url" content="https://blog.ronan.us.kg/posts/gdb%E8%B0%83%E8%AF%95/">
  <meta property="og:site_name" content="Ronan Blog">
  <meta property="og:title" content="GDB调试">
  <meta property="og:description" content="gdb 是由 GNU 软件系统社区提供的调试器，同 gcc 配套组成了一套完整的开发环境，可移植性很好，支持非常多的体系结构并被移植到各种系统中（包括各种类 Unix 系统与 Windows 系统里的 MinGW 和 Cygwin ）。此外，除了 C 语言之外，gcc/gdb 还支持包括 C&#43;&#43;、Objective-C、Ada 和 Pascal 等各种语言后端的编译和调试。 gcc/gdb 是 Linux 和许多类 Unix 系统中的标准开发环境，Linux 内核也是专门针对 gcc 进行编码的。
gdb 的吉祥物是专门捕杀 bug 的射手鱼，官方有这样一段描述:
For a fish, the archer fish is known to shoot down bugs from low hanging plants by spitting water at them.
作为一种鱼，射手鱼以喷水射下低垂的植物上的虫子而闻名。
GDB 是一套字符界面的程序集，可以使用命令 gdb 加载要调试的程序。 下面为大家介绍一些常用的GDB调试命令。
1.调试准备 项目程序如果是为了进行调试而编译时， 必须要打开调试选项(-g)。另外还有一些可选项，比如: 在尽量不影响程序行为的情况下关掉编译器的优化选项(-O0)，-Wall选项打开所有 warning，也可以发现许多问题，避免一些不必要的 bug。
-g选项的作用是在可执行文件中加入源代码的信息，比如可执行文件中第几条机器指令对应源代码的第几行，但并不是把整个源文件嵌入到可执行文件中，所以在调试时必须保证gdb能找到源文件。
习惯上如果是c程序就使用gcc编译, 如果是 c&#43;&#43;程序就使用g&#43;&#43;编译, 编译命令中添加上边提到的参数即可。">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-22T13:28:58+08:00">
    <meta property="article:modified_time" content="2024-10-22T13:28:58+08:00">


    


    

    
    <link rel="canonical" href="https://blog.ronan.us.kg/posts/gdb%E8%B0%83%E8%AF%95/">
    

    

    



    
    <link id="theme-css" rel="stylesheet" href="https://blog.ronan.us.kg/theme.min.8125c5e195258aa61b74485a7c4accfba7efc242481cb11437cb6d93789d00e7.css" integrity="sha256-gSXF4ZUliqYbdEhafErM&#43;6fvwkJIHLEUN8ttk3idAOc=" media="screen" crossorigin="anonymous">



    



    

    
</head>

<body class="bilberry-hugo-theme">
    

    
    <nav>

    <div class="container">
        <ul class="topnav">
            
        </ul>

        
            <div id="search-box" class="search">
                <i class="fas fa-search"></i>
                <input id="search" type="text" placeholder="Search ...">
            </div>
        
    </div>
</nav>


    
    <header>

    <a id="back-to-top-button">
        <i class="fas fa-angle-up"></i>
    </a>

    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://imgs.ronan.us.kg/avatar.jpg" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title">
                <a href="/">
                    Ronan Blog
                </a>
            </h3>

            
                <span class="subtitle">「向前每多走一步，热爱和勇气就会多一分。」</span>
            
        </div>
        <div class="selectors">
          
          
       </div>

        
            <div class="toggler">
        
                <i class="fa fa-bars" aria-hidden="true"></i>
            </div>
    </div>
    </div>
</header>


    <div class="main container">
        
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://blog.ronan.us.kg/posts/gdb%E8%B0%83%E8%AF%95/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title">
        <a href="https://blog.ronan.us.kg/posts/gdb%E8%B0%83%E8%AF%95/">
            GDB调试
        </a>
    </h1>

    <div class="meta">
        
            
                <span class="date moment">2024-10-22</span>
            
        

        

        
            <span class="categories">
                
                    
                    
                        <a href="https://blog.ronan.us.kg/categories/docs/">Docs</a>
                    
                
            </span>
        

        
            <span class="author">
                
                
                    <a href="https://blog.ronan.us.kg/author/ronan/">Ronan</a>
                
            </span>
        
    </div>

    
        

        <p>gdb 是由 GNU 软件系统社区提供的调试器，同 gcc 配套组成了一套完整的开发环境，可移植性很好，支持非常多的体系结构并被移植到各种系统中（包括各种类 Unix 系统与 Windows 系统里的 MinGW 和 Cygwin ）。此外，除了 C 语言之外，gcc/gdb 还支持包括 C++、Objective-C、Ada 和 Pascal 等各种语言后端的编译和调试。 gcc/gdb 是 Linux 和许多类 Unix 系统中的标准开发环境，Linux 内核也是专门针对 gcc 进行编码的。</p>
<p>gdb 的吉祥物是专门捕杀 bug 的射手鱼，官方有这样一段描述:</p>
<blockquote>
<p>For a fish, the archer fish is known to shoot down bugs from low hanging plants by spitting water at them.</p>
<p>作为一种鱼，射手鱼以喷水射下低垂的植物上的虫子而闻名。</p>
</blockquote>
<p>GDB 是一套字符界面的程序集，可以使用命令 gdb 加载要调试的程序。 下面为大家介绍一些常用的GDB调试命令。</p>
<h1 id="1调试准备">1.调试准备</h1>
<p>项目程序如果是为了进行调试而编译时， 必须要打开调试选项(<code>-g</code>)。另外还有一些可选项，比如: 在尽量不影响程序行为的情况下关掉编译器的优化选项(<code>-O0</code>)，<code>-Wall</code>选项打开所有 warning，也可以发现许多问题，避免一些不必要的 bug。</p>
<p><code>-g</code>选项的作用是在可执行文件中加入源代码的信息，比如可执行文件中第几条机器指令对应源代码的第几行，但并不是把整个源文件嵌入到可执行文件中，所以在调试时必须保证gdb能找到源文件。</p>
<p>习惯上如果是c程序就使用gcc编译, 如果是 c++程序就使用g++编译, 编译命令中添加上边提到的参数即可。</p>
<blockquote>
<p>假设有一个文件 args.c, 要对其进行gdb调试，编译的时候必须要添加参数 -g，加入了源代码信息的可执行文件比不加之前要大一些。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># -g 将调试信息写入到可执行程序中</span>
</span></span><span style="display:flex;"><span>$ gcc -g args.c -o app
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 编译不添加 -g 参数</span>
</span></span><span style="display:flex;"><span>$ gcc args.c -o app1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看生成的两个可执行程序的大小</span>
</span></span><span style="display:flex;"><span>$ ll
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-rwxrwxr-x  <span style="color:#ae81ff">1</span> robin robin <span style="color:#ae81ff">9816</span> Apr <span style="color:#ae81ff">19</span> 09:25 app*	<span style="color:#75715e"># 可以用于gdb调试</span>
</span></span><span style="display:flex;"><span>-rwxrwxr-x  <span style="color:#ae81ff">1</span> robin robin <span style="color:#ae81ff">8608</span> Apr <span style="color:#ae81ff">19</span> 09:25 app1*	<span style="color:#75715e"># 不能用于gdb调试</span>
</span></span></code></pre></div><h1 id="2启动和退出gdb">2.启动和退出gdb</h1>
<h2 id="21-启动gdb">2.1 启动gdb</h2>
<blockquote>
<p>gdb是一个用于应用程序调试的进程, 需要先将其打开, 一定要注意 gdb进程启动之后, 需要的被调试的应用程序是没有执行的。打开Linux终端，切换到要调试的可执行程序所在路径，执行如下命令就可以启动 gdb了。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 在终端中执行如下命令</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb程序启动了, 但是可执行程序并没有执行</span>
</span></span><span style="display:flex;"><span>$ gdb 可执行程序的名字
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用举例：</span>
</span></span><span style="display:flex;"><span>$ gdb app
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> 		<span style="color:#75715e"># gdb等待输入调试的相关命令</span>
</span></span></code></pre></div><h2 id="22-命令行传参">2.2 命令行传参</h2>
<p>有些程序在启动的时候需要传递命令行参数，如果要调试这类程序，这些命令行参数必须要在应用程序启动之前通过调试程序的gdb进程传递进去。下面是一段带命令行参数的程序：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>// args.c
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdio.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;stdlib.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;unistd.h&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include &lt;string.h&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define NUM 10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// argc, argv 是命令行参数
</span></span><span style="display:flex;"><span>// 启动应用程序的时候
</span></span><span style="display:flex;"><span>int main<span style="color:#f92672">(</span>int argc, char* argv<span style="color:#f92672">[])</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;参数个数: %d\n&#34;</span>, argc<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span>int i<span style="color:#f92672">=</span>0; i&lt;argc; ++i<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;%d\n&#34;</span>, NUM<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>        printf<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;参数 %d: %s\n&#34;</span>, i, argv<span style="color:#f92672">[</span>i<span style="color:#f92672">])</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>第一步: 编译出带条信息的可执行程序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ gcc args.c -o app -g
</span></span></code></pre></div><p>第二步: 启动gdb进程, 指定需要gdb调试的应用程序名称</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ gdb app
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>第三步: 在启动应用程序 app之前设置命令行参数。gdb中设置参数的命令叫做set args &hellip;，查看设置的命令行参数命令是 show args。 语法格式如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 设置的时机: 启动gdb之后, 在应用程序启动之前</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> set args 参数1 参数2 .... ...
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看设置的命令行参数</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> show args
</span></span></code></pre></div><p>使用举例：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 非gdb调试命令行传参</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># argc 参数总个数，argv[0] == ./app， argv[1] == &#34;11&#34;  argv[2] == &#34;22&#34;  ...  argv[5] == &#34;55&#34;</span>
</span></span><span style="display:flex;"><span>$ ./app <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">22</span> <span style="color:#ae81ff">33</span> <span style="color:#ae81ff">44</span> 55		<span style="color:#75715e"># 这是数据传递给main函数</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用 gdb 调试</span>
</span></span><span style="display:flex;"><span>$ gdb app
</span></span><span style="display:flex;"><span>GNU gdb <span style="color:#f92672">(</span>Ubuntu 7.11.1-0ubuntu1~16.5<span style="color:#f92672">)</span> 7.11.1
</span></span><span style="display:flex;"><span>Copyright <span style="color:#f92672">(</span>C<span style="color:#f92672">)</span> <span style="color:#ae81ff">2016</span> Free Software Foundation, Inc.
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 通过gdb给应用程序设置命令行参数</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> set args <span style="color:#ae81ff">11</span> <span style="color:#ae81ff">22</span> <span style="color:#ae81ff">33</span> <span style="color:#ae81ff">44</span> <span style="color:#ae81ff">55</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看设置的命令行参数</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> show args
</span></span><span style="display:flex;"><span>Argument list to give program being debugged when it is started is <span style="color:#e6db74">&#34;11 22 33 44 55&#34;</span>.
</span></span></code></pre></div><h2 id="23-gdb中启动程序">2.3 gdb中启动程序</h2>
<p>在gdb中启动要调试的应用程序有两种方式, 一种是使用<code>run</code>命令, 另一种是使用<code>start</code>命令启动。在整个 gdb 调试过程中, 启动应用程序的命令只能使用一次。</p>
<ul>
<li><code>run</code>: 可以缩写为 r, 如果程序中设置了断点会停在第一个断点的位置, 如果没有设置断点, 程序就执行完了</li>
<li><code>start</code>: 启动程序, 最终会阻塞在main函数的第一行，等待输入后续其它 gdb 指令</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 两种方式</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 方式1: run == r</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> run
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 方式2: start</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> start
</span></span></code></pre></div><p>如果想让程序start之后继续运行, 或者在断点处继续运行，可以使用 continue命令, 可以简写为 c</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># continue == c</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> <span style="color:#66d9ef">continue</span>
</span></span></code></pre></div><h2 id="24-退出gdb">2.4 退出gdb</h2>
<p>退出gdb调试, 就是终止 gdb 进程, 需要使用 quit命令, 可以缩写为 q</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># quit == q</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> quit
</span></span></code></pre></div><h1 id="3查看代码">3.查看代码</h1>
<p>因为gdb调试没有IDE那样的完善的可视化窗口界面，给调试的程序打断点又是调试之前必须做的一项工作。因此gdb提供了查看代码的命令，这样就可以轻松定位要调试的代码行的位置了。</p>
<p>查看代码的命令叫做list可以缩写为 l, 通过这个命令我们可以查看项目中任意一个文件中的内容，并且还可以通过文件行号，函数名等方式查看。</p>
<h2 id="31-当前文件">3.1 当前文件</h2>
<p>一个项目中一般是有很多源文件的, 默认情况下通过list查看到代码信息位于程序入口函数main对应的的那个文件中。因此如果不进行文件切换main函数所在的文件就是当前文件, 如果进行了文件切换, 切换到哪个文件哪个文件就是当前文件。查看文件内容的方式如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 使用 list 和使用 l 都可以</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 从第一行开始显示</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> list
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 列值这行号对应的上下文代码, 默认情况下只显示10行内容</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> list 行号
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 显示这个函数的上下文内容, 默认显示10行</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> list 函数名
</span></span></code></pre></div><p>通过list去查看文件代码, 默认只显示10行, 如果还想继续查看后边的内容, 可以继续执行list命令, 也可以直接回车（再次执行上一次执行的那个gdb命令）。</p>
<h2 id="32-切换文件">3.2 切换文件</h2>
<p>在查看文件内容的时候，很多情况下需要进行文件切换，我们只需要在list命令后边将要查看的文件名指定出来就可以了，切换命令执行完毕之后，这个文件就变成了当前文件。文件切换方式如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 切换到指定的文件，并列出这行号对应的上下文代码, 默认情况下只显示10行内容</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> l 文件名:行号
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 切换到指定的文件，并显示这个函数的上下文内容, 默认显示10行</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> l 文件名:函数名
</span></span></code></pre></div><h2 id="33-设置显示的行数">3.3 设置显示的行数</h2>
<p>默认通过list只能一次查看10行代码, 如果想显示更多, 可以通过set listsize设置, 同样如果想查看当前显示的行数可以通过 show listsize查看, 这里的listsize可以简写为 list。具体语法格式如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 以下两个命令中的 listsize 都可以写成 list</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> set listsize 行数
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看当前list一次显示的行数</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> show listsize
</span></span></code></pre></div><h1 id="4断点操作">4.断点操作</h1>
<p>想要通过gdb调试某一行或者得到某个变量在运行状态下的实际值，就需要在在这一行设置断点，程序指定到断点的位置就会阻塞，我们就可以通过gdb的调试命令得到我们想要的信息了。</p>
<p>设置断点的命令叫做break可以缩写为b。</p>
<h2 id="41-设置断点">4.1 设置断点</h2>
<p>断点的设置有两种方式一种是常规断点，程序只要运行到这个位置就会被阻塞，还有一种叫条件断点，只有指定的条件被满足了程序才会在断点处阻塞。</p>
<p>调试程序的断点可以设置到某个具体的行, 也可以设置到某个函数上，具体的设置方式如下：</p>
<ul>
<li>
<p>设置普通断点到当前文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 在当前文件的某一行上设置断点</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># break == b</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> b 行号
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> b 函数名		<span style="color:#75715e"># 停止在函数的第一行</span>
</span></span></code></pre></div></li>
<li>
<p>设置普通断点到某个非当前文件上</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 在非当前文件的某一行上设置断点</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> b 文件名:行号
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> b 文件名:函数名		<span style="color:#75715e"># 停止在函数的第一行</span>
</span></span></code></pre></div></li>
<li>
<p>设置条件断点</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 必须要满足某个条件, 程序才会停在这个断点的位置上</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 通常情况下, 在循环中条件断点用的比较多</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> b 行数 <span style="color:#66d9ef">if</span> 变量名<span style="color:#f92672">==</span>某个值
</span></span></code></pre></div></li>
</ul>
<h2 id="42-查看断点">4.2 查看断点</h2>
<p>断点设置完毕之后, 可以通过 info break命令查看设置的断点信息，其中info可以缩写为i</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># info == i</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看设置的断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b   <span style="color:#75715e">#info break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 举例</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>       breakpoint     keep y   0x0000000000400cb5 in main<span style="color:#f92672">()</span> at test.cpp:12
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep y   0x0000000000400cbd in main<span style="color:#f92672">()</span> at test.cpp:13
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span>       breakpoint     keep y   0x0000000000400cec in main<span style="color:#f92672">()</span> at test.cpp:18
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep y   0x00000000004009a5 in insertionSort<span style="color:#f92672">(</span>int*, int<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                                                   at insert.cpp:8
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep y   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep y   0x00000000004009e5 in insertionSort<span style="color:#f92672">(</span>int*, int<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                                                   at insert.cpp:16
</span></span></code></pre></div><p>在显示的断点信息中有一些属性需要在其他操作中被使用, 下面介绍一下:</p>
<ul>
<li>Num: 断点的编号, 删除断点或者设置断点状态的时候都需要使用</li>
<li>Enb: 当前断点的状态, y表示断点可用, n表示断点不可用</li>
<li>What: 描述断点被设置在了哪个文件的哪一行或者哪个函数上</li>
</ul>
<h2 id="43-删除断点">4.3 删除断点</h2>
<p>如果确定设置的某个断点不再被使用了, 可用将其删除, 删除命令是 delete 断点编号, 这个delete可以简写为del也可以再简写为d。</p>
<p>删除断点的方式有两种: 删除(一个或者多个)指定断点或者删除一个连续的断点区间，具体操作如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># delete == del == d</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 需要 info b 查看断点的信息, 第一列就是编号</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> d 断点的编号1 <span style="color:#f92672">[</span>断点编号2 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 举例:</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> d <span style="color:#ae81ff">1</span>          <span style="color:#75715e"># 删除第1个断点</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> d <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">6</span>      <span style="color:#75715e"># 删除第2,4,6个断点</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除一个范围, 断点编号 num1 - numN 是一个连续区间</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> d num1-numN
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 举例, 删除第1到第5个断点</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> d 1-5
</span></span></code></pre></div><h2 id="44-设置断点状态">4.4 设置断点状态</h2>
<p>如果某个断点只是临时不需要了，我们可以将其设置为不可用状态, 设置命令为disable 断点编号，当需要的时候再将其设置回可用状态，设置命令为 enable 断点编号。</p>
<ul>
<li>
<p>设置断点无效</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 让断点失效之后, gdb调试过程中程序是不会停在这个位置的</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># disable == dis</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置某一个或者某几个断点无效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> dis 断点1的编号 <span style="color:#f92672">[</span>断点2的编号 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置某个区间断点无效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> dis 断点1编号-断点n编号
</span></span></code></pre></div></li>
<li>
<p>演示设置断点为无效状态:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 查看断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep y   0x0000000000400cce in main<span style="color:#f92672">()</span> at test.cpp:14
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep y   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep y   0x0000000000400d46 in main<span style="color:#f92672">()</span> at test.cpp:23
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep y   0x0000000000400d4e in main<span style="color:#f92672">()</span> at test.cpp:25
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       breakpoint     keep y   0x0000000000400d6e in main<span style="color:#f92672">()</span> at test.cpp:28
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       breakpoint     keep y   0x0000000000400d7d in main<span style="color:#f92672">()</span> at test.cpp:30
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置第2, 第4 个断点无效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> dis <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep n   0x0000000000400cce in main<span style="color:#f92672">()</span> at test.cpp:14
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep n   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep y   0x0000000000400d46 in main<span style="color:#f92672">()</span> at test.cpp:23
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep y   0x0000000000400d4e in main<span style="color:#f92672">()</span> at test.cpp:25
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       breakpoint     keep y   0x0000000000400d6e in main<span style="color:#f92672">()</span> at test.cpp:28
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       breakpoint     keep y   0x0000000000400d7d in main<span style="color:#f92672">()</span> at test.cpp:30
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置 第5,6,7,8个 断点无效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> dis 5-8
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep n   0x0000000000400cce in main<span style="color:#f92672">()</span> at test.cpp:14
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep n   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep n   0x0000000000400d46 in main<span style="color:#f92672">()</span> at test.cpp:23
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep n   0x0000000000400d4e in main<span style="color:#f92672">()</span> at test.cpp:25
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       breakpoint     keep n   0x0000000000400d6e in main<span style="color:#f92672">()</span> at test.cpp:28
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       breakpoint     keep n   0x0000000000400d7d in main<span style="color:#f92672">()</span> at test.cpp:30
</span></span></code></pre></div></li>
<li>
<p>让无效的断点生效</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># enable == ena</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置某一个或者某几个断点有效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ena 断点1的编号 <span style="color:#f92672">[</span>断点2的编号 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置某个区间断点有效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ena 断点1编号-断点n编号
</span></span></code></pre></div></li>
<li>
<p>演示设置断点为有效状态:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 查看断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep n   0x0000000000400cce in main<span style="color:#f92672">()</span> at test.cpp:14
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep n   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep n   0x0000000000400d46 in main<span style="color:#f92672">()</span> at test.cpp:23
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep n   0x0000000000400d4e in main<span style="color:#f92672">()</span> at test.cpp:25
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       breakpoint     keep n   0x0000000000400d6e in main<span style="color:#f92672">()</span> at test.cpp:28
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       breakpoint     keep n   0x0000000000400d7d in main<span style="color:#f92672">()</span> at test.cpp:30
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置第2, 第4个断点有效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ena <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep y   0x0000000000400cce in main<span style="color:#f92672">()</span> at test.cpp:14
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep y   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep n   0x0000000000400d46 in main<span style="color:#f92672">()</span> at test.cpp:23
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep n   0x0000000000400d4e in main<span style="color:#f92672">()</span> at test.cpp:25
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       breakpoint     keep n   0x0000000000400d6e in main<span style="color:#f92672">()</span> at test.cpp:28
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       breakpoint     keep n   0x0000000000400d7d in main<span style="color:#f92672">()</span> at test.cpp:30
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 设置第5,6,7个断点有效</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ena 5-7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看断点信息</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i b
</span></span><span style="display:flex;"><span>Num     Type           Disp Enb Address            What
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>       breakpoint     keep y   0x0000000000400cce in main<span style="color:#f92672">()</span> at test.cpp:14
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>       breakpoint     keep y   0x0000000000400cdd in main<span style="color:#f92672">()</span> at test.cpp:16
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">5</span>       breakpoint     keep y   0x0000000000400d46 in main<span style="color:#f92672">()</span> at test.cpp:23
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>       breakpoint     keep y   0x0000000000400d4e in main<span style="color:#f92672">()</span> at test.cpp:25
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7</span>       breakpoint     keep y   0x0000000000400d6e in main<span style="color:#f92672">()</span> at test.cpp:28
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span>       breakpoint     keep n   0x0000000000400d7d in main<span style="color:#f92672">()</span> at test.cpp:30
</span></span></code></pre></div></li>
</ul>
<h1 id="5调试命令">5.调试命令</h1>
<h2 id="51-继续运行gdb">5.1 继续运行gdb</h2>
<p>如果调试的程序被断点阻塞了又想让程序继续执行，这时候就可以使用continue命令。程序会继续运行, 直到遇到下一个有效的断点。continue可以缩写为 c。</p>
<pre tabindex="0"><code># continue == c
(gdb) continue
</code></pre><h2 id="52-手动打印信息">5.2 手动打印信息</h2>
<p>当程序被某个断点阻塞之后, 可以通过一些命令打印变量的名字或者变量的类型，并且还可以跟踪打印某个变量的值。</p>
<h3 id="521-打印变量值">5.2.1 打印变量值</h3>
<p>在gdb调试的时候如果需要打印变量的值， 使用的命令是 print, 可缩写为 p。如果打印的变量是整数还可以指定输出的整数的格式, 格式化输出的整数对应的字符表如下：</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">格式化字符 (/fmt)</th>
          <th style="text-align: center">说明</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">/x</td>
          <td style="text-align: center">以十六进制的形式打印出整数。</td>
      </tr>
      <tr>
          <td style="text-align: center">/d</td>
          <td style="text-align: center">以有符号、十进制的形式打印出整数。</td>
      </tr>
      <tr>
          <td style="text-align: center">/u</td>
          <td style="text-align: center">以无符号、十进制的形式打印出整数。</td>
      </tr>
      <tr>
          <td style="text-align: center">/o</td>
          <td style="text-align: center">以八进制的形式打印出整数。</td>
      </tr>
      <tr>
          <td style="text-align: center">/t</td>
          <td style="text-align: center">以二进制的形式打印出整数。</td>
      </tr>
      <tr>
          <td style="text-align: center">/f</td>
          <td style="text-align: center">以浮点数的形式打印变量或表达式的值。</td>
      </tr>
      <tr>
          <td style="text-align: center">/c</td>
          <td style="text-align: center">以字符形式打印变量或表达式的值。</td>
      </tr>
  </tbody>
</table>
<p>print命令的语法格式如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># print == p</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> p 变量名
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如果变量是一个整形, 默认对应的值是以10进制格式输出, 其他格式请参考上表</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> p/fmt 变量名
</span></span></code></pre></div><p>举例:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 举例</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> p i       <span style="color:#75715e"># 10进制</span>
</span></span><span style="display:flex;"><span>$5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> p/x i     <span style="color:#75715e"># 16进制</span>
</span></span><span style="display:flex;"><span>$6 <span style="color:#f92672">=</span> 0x3
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> p/o i     <span style="color:#75715e"># 8进制</span>
</span></span><span style="display:flex;"><span>$7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">03</span>
</span></span></code></pre></div><h3 id="522-打印变量类型">5.2.2 打印变量类型</h3>
<p>如果在调试过程中需要查看某个变量的类型, 可以使用命令ptype, 语法格式如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 语法格式</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ptype 变量名
</span></span></code></pre></div><p>举例:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 打印变量类型</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ptype i
</span></span><span style="display:flex;"><span>type <span style="color:#f92672">=</span> int
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ptype array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>type <span style="color:#f92672">=</span> int
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> ptype array
</span></span><span style="display:flex;"><span>type <span style="color:#f92672">=</span> int <span style="color:#f92672">[</span>12<span style="color:#f92672">]</span>
</span></span></code></pre></div><h2 id="53-自动打印信息">5.3 自动打印信息</h2>
<h3 id="531-设置变量名自动显示">5.3.1 设置变量名自动显示</h3>
<p>和 print 命令一样，display 命令也用于调试阶段查看某个变量或表达式的值，它们的区别是，使用 display 命令查看变量或表达式的值，每当程序暂停执行（例如单步执行）时，GDB 调试器都会自动帮我们打印出来，而 print 命令则不会。因此，当我们想频繁查看某个变量或表达式的值从而观察它的变化情况时，使用 display 命令可以一劳永逸。display 命令没有缩写形式，常用的语法格式如下 2 种：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 在变量的有效取值范围内, 自动打印变量的值(设置一次, 以后就会自动显示)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> display 变量名
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 以指定的整形格式打印变量的值, 关于 fmt 的取值, 请参考 print 命令</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> display/fmt 变量名
</span></span></code></pre></div><h3 id="532-查看自动显示列表">5.3.2 查看自动显示列表</h3>
<p>对于使用 display 命令查看的目标变量或表达式，都会被记录在一张列表（称为自动显示列表）中。通过执行info dispaly命令，可以打印出这张表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># info == i</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> info display
</span></span><span style="display:flex;"><span>Auto-display expressions now in effect:
</span></span><span style="display:flex;"><span>Num Enb Expression
</span></span><span style="display:flex;"><span>1:   y  i
</span></span><span style="display:flex;"><span>2:   y  array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>3:   y  /x array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>在展示出的信息中, 每个列的含义如下:</p>
<ul>
<li>Num : 变量或表达式的编号，GDB 调试器为每个变量或表达式都分配有唯一的编号</li>
<li>Enb : 表示当前变量（表达式）是处于激活状态还是禁用状态，如果处于激活状态（用 y 表示），则每次程序停止执行，该变量的值都会被打印出来；反之，如果处于禁用状态（用 n 表示），则该变量（表达式）的值不会被打印。</li>
<li>Expression ：被自动打印值的变量或表达式的名字。</li>
</ul>
<h3 id="533-取消自动显示">5.3.3 取消自动显示</h3>
<p>对于不需要再打印值的变量或表达式，可以将其删除或者禁用。</p>
<ul>
<li>
<p>删除自动显示列表中的变量或表达式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 命令中的 num 是通过 info display 得到的编号, 编号可以是一个或者多个</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> undisplay num <span style="color:#f92672">[</span>num1 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># num1 - numN 表示一个范围</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> undisplay num1-numN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> delete display num <span style="color:#f92672">[</span>num1 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> delete display num1-numN
</span></span></code></pre></div></li>
<li>
<p>举例说明:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 查看显示列表</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> info display
</span></span><span style="display:flex;"><span>Auto-display expressions now in effect:
</span></span><span style="display:flex;"><span>Num Enb Expression
</span></span><span style="display:flex;"><span>1:   y  i
</span></span><span style="display:flex;"><span>2:   y  array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>3:   y  /x array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 删除变量显示, 需要使用 info display 得到的变量/表达式编号</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> undisplay <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 查看显示列表, 只剩下一个了</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> i display
</span></span><span style="display:flex;"><span>Auto-display expressions now in effect:
</span></span><span style="display:flex;"><span>Num Enb Expression
</span></span><span style="display:flex;"><span>3:   y  /x array<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span>
</span></span></code></pre></div></li>
<li>
<p>如果不想删除自动显示的变量, 也可以禁用自动显示列表中处于激活状态下的变量或表达式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 命令中的 num 是通过 info display 得到的编号, 编号可以是一个或者多个</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> disable display num <span style="color:#f92672">[</span>num1 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># num1 - numN 表示一个范围</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> disable display num1-numN
</span></span></code></pre></div></li>
<li>
<p>当需要启用自动显示列表中被禁用的变量或表达式时, 可以使用下边的命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 命令中的 num 是通过 info display 得到的编号, 编号可以是一个或者多个</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> enable  display num <span style="color:#f92672">[</span>num1 ...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># num1 - numN 表示一个范围</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> disable display num1-numN
</span></span></code></pre></div></li>
</ul>
<h2 id="53-单步调试">5.3 单步调试</h2>
<p>当程序阻塞到某个断点上之后, 可以通过以下命令对程序进行单步调试:</p>
<h3 id="531-step">5.3.1 step</h3>
<p>step命令可以缩写为s, 命令被执行一次代码被向下执行一行，如果这一行是一个函数调用，那么程序会进入到函数体内部。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 从当前代码行位置, 一次调试当前行下的每一行代码</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># step == s</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如果这一行是函数调用, 执行这个命令, 就可以进入到函数体的内部</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> step
</span></span></code></pre></div><h3 id="532-finish">5.3.2 finish</h3>
<p>如果通过 s 单步调试进入到函数内部, 想要跳出这个函数体， 可以执行finish命令。如果想要跳出函数体必须要保证函数体内不能有有效断点，否则无法跳出。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 如果通过 s 单步调试进入到函数内部, 想要跳出这个函数体</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> finish
</span></span></code></pre></div><h3 id="533-next">5.3.3 next</h3>
<p>next命令和step命令功能是相似的，只是在使用next调试程序的时候不会进入到函数体内部，next可以缩写为 n</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># next == n</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如果这一行是函数调用, 执行这个命令, 不会进入到函数体的内部</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> next
</span></span></code></pre></div><h3 id="534-until">5.3.4 until</h3>
<p>通过 until 命令可以直接跳出某个循环体，这样就能提高调试效率了。如果想直接从循环体中跳出, 必须要满足以下的条件，否则命令不会生效：</p>
<ul>
<li>
<p>要跳出的循环体内部不能有有效的断点</p>
</li>
<li>
<p>必须要在循环体的开始/结束行执行该命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> <span style="color:#66d9ef">until</span>
</span></span></code></pre></div></li>
</ul>
<h2 id="54-设置变量值">5.4 设置变量值</h2>
<p>在调试程序的时候, 我们需要在某个变量等于某个特殊值的时候查看程序的运行状态, 但是通过程序运行让变量等于这个值又非常困难, 这种情况下就可以在 gdb 中直接对这个变量进行值的设置, 或者是在单步调试的时候通过设置循环因子的值直接跳出某个循环, 值设置的命令格式为: <code>set var 变量名=值</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 可以在循环中使用, 直接设置循环因子的值</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 假设某个变量的值在程序中==90的概率是5%, 这时候可以直接通过命令将这个变量值设置为90</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> set var 变量名<span style="color:#f92672">=</span>值
</span></span></code></pre></div>
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
    </div>

    
        <div id="comments-container">
            
            

            

            

        </div>
    

    </div>

    
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
            <ul>
                
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/pyinstaller%E5%B0%86python%E5%BA%94%E7%94%A8%E6%89%93%E5%8C%85%E4%B8%BAandroid%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/">PyInstaller将Python应用打包为Android应用程序</a>
                    </li>
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/gmeek%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC%E5%8D%95%E7%AF%87%E6%88%96%E6%89%B9%E9%87%8F/">「Gmeek」上传脚本(单篇或批量)</a>
                    </li>
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/platformioprintf-%E9%87%8D%E6%98%A0%E5%83%8F%E4%B8%B2%E5%8F%A3%E6%89%93%E5%8D%B0%E6%95%B0%E6%8D%AE/">「platformIO」printf 重映像、串口打印数据</a>
                    </li>
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/python%E6%A8%A1%E5%9D%97%E5%92%8C%E5%8C%85/">「Python」模块和包</a>
                    </li>
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/pythonconda%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/">「python」Conda虚拟环境</a>
                    </li>
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/python%E4%B8%80%E4%B8%AA%E5%BF%AB%E9%80%9F%E7%94%9F%E6%88%90requirements.txt%E7%9A%84%E5%BA%93/">「python」一个快速生成requirements.txt的库</a>
                    </li>
                
                    <li>
                        <a href="https://blog.ronan.us.kg/posts/orbstackmac-%E7%B3%BB%E7%BB%9F%E4%B8%AD%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%BF%AB%E7%9A%84-docker-%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7%E5%8F%AF%E5%AE%8C%E5%85%A8%E6%9B%BF%E4%BB%A3-docker-desktop/">「OrbStack」Mac 系统中一个更快的 Docker 可视化工具，可完全替代 Docker Desktop</a>
                    </li>
                
            </ul>
        </div>
        

        
        <div class="categories">
            
            <a href="https://blog.ronan.us.kg/categories/"><strong>Categories</strong></a>
            

            <ul>
                
                <li>
                
                    <a href="https://blog.ronan.us.kg/categories/docs/">Docs (38)</a>
                
                </li>
                
                <li>
                
                    <a href="https://blog.ronan.us.kg/categories/linux/">Linux (11)</a>
                
                </li>
                
                <li>
                
                    <a href="https://blog.ronan.us.kg/categories/macos/">Macos (5)</a>
                
                </li>
                
                <li>
                
                    <a href="https://blog.ronan.us.kg/categories/tools/">Tools (5)</a>
                
                </li>
                
                <li>
                
                    <a href="https://blog.ronan.us.kg/categories/vscode/">Vscode (4)</a>
                
                </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>
                
                <a href="https://weibo.com/u/5995159469" target="_blank" rel="me"><em class="fab fa-weibo"></em></a>
                
                <a href="https://github.com/EchoZap" target="_blank" rel=""><em class="fab fa-github"></em></a>
                
            </div>
            

            

            
            <div class="archive">
                
                <a href="https://blog.ronan.us.kg/archive/"><strong>Archive</strong></a>
                
            </div>
            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/echozap" target="_blank">
                &copy;
                
                2024
                
                by Ronan
            </a>
            
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme"
                target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


    

    

    


    

    

    

    

    

    

    

    



    
    
    



    
    







    
    <script src="https://blog.ronan.us.kg/theme.min.15a051027515397e36946f37800e8a370e44f72ac97de37ae55b55087e3b0b59.js" integrity="sha256-FaBRAnUVOX42lG83gA6KNw5E9yrJfeN65VtVCH47C1k=" crossorigin="anonymous"></script>



    



    
        <div id="activate-algolia-search" class="hidden">
  <input type="hidden" id="algolia-search-appId" value="GT5UPRMBE6">
  <input type="hidden" id="algolia-search-apiKey" value="9499608ea45258a283445ca59ad50c14">
  <input type="hidden" id="algolia-search-indexName" value="hugo">
  <input type="hidden" id="algolia-search-noSearchResults" value="Nothing found.">

  
  <input type="hidden" id="algolia-search-currentLanguageOnly">
  
</div>

    

    
</body>

</html>
